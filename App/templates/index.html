{% extends "layout.html" %}
{% block title %}Fitness 360{% endblock %}
{% block page %}Fitness 360{% endblock %}

{{ super() }}

{% block content %}
<style>

.popup-container {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 9999;
}

.popup-content {
    padding: 20px;
    background-color: white;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

.popup-content form {
    margin-bottom: 10px;
}

.popup-content button {
    margin-right: 10px;
}
.popup-content #close-popup-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1.5em;
    color: #999;
}
    .custom-black {
    background-color: #1c1c1c; 
}
    .container{
        padding: 10px;
        background-color: rgb(216, 212, 212);
        display: flex;
        align-items: center;
    }
    .column {
        float: left;
        padding: 10px;
        height: 90vh; /* Adjust as needed */
        overflow-y: auto;
    }
    .left {
        width: 25%;
    }
    .row {
    display: flex; 
    justify-content: center; 
    align-items: center;
    height: 100vh;
}


.column.middle {
    display: flex; 
    justify-content: center; 
    align-items: center; 
    flex-direction: column;
    width: 50%; 
}
    .right {
        width: 25%;
    }
    .row:after {
        content: "";
        display: table;
        clear: both;
    }
    .smaller-image {
        width: 300px; /* Adjust as needed */
        height: 400px;
    }
</style>


<!--Left side navigation bar to select an exercise-->
<section  style="margin-top: 5px; overflow-y:scroll; height: 86vh">
    <ul id="slide-out" class="sidenav sidenav-fixed">
        <nav class="nav-extended custom-black" style="margin-bottom:10px">
            <div class="nav-wrapper">
            <a href="#" style="font-size:1.2em" class="brand-logo">Let's get ripped: {{current_user.username}} </a>
            </div>
        </nav>

        
        <!-- Left column content (Select an Exercise) -->
        <h5>Select An Exercise</h5>
        <div class="input-field col s12">
            <div class="scrollable-list collection with-scroller">
                {% for workout in workouts %}
                    {% if workout.id == selected_workout.id %}
                        <a href="/app/{{workout.workout_id}}" class="collection-item active">{{ workout.exercise_name }}</a>
                    {% else %}
                        <a href="/app/{{workout.workout_id}}" class="collection-item">{{ workout.exercise_name }}</a><br>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
            
    </ul>
</section>
    
<div class="row">
    <!-- Left middle Column  -->
    <div class="column">
        <!-- Popup container for routine details -->
{% if selected_routine %}
<div class="popup-container" id="routine-popup" style="display: none;">
    <div class="popup-content card">
        <h3 id="routine-popup-title">Routine Details</h3>
        <form id="routine-form">
            <label for="routine-name">Name:</label>
            <input type="text" id="routine-name" name="routine-name" required value="{{selected_routine.name}}">
            <button type="button" id="edit-name-btn">Edit Name</button>
            <br>
            <label for="exercise-list">Exercises:</label>
            <ul id="exercise-list">
                <!-- List of exercises will be added dynamically -->
                {% for workout in user_routines %}
                <li>{{workout.exercise_name}}</li>
                {% endfor %}
            </ul>
            <select id="exercise-dropdown">
                <!-- Dropdown options for exercises will be added dynamically -->
                {% for workout in workouts %}
                <option value="{{workout.workout_id}}" class="collection-item">{{ workout.exercise_name }}</option>
                {% endfor %}
            </select>
            <button type="button" id="add-exercise-btn">Add Exercise</button>
            <button type="submit" id="finish-btn">Finish</button>
            <button type="button" id="deleteBtn">Delete</button>
        </form>
        <button type="button" id="close-popup-btn">Close</button>
    </div>
</div>
{% endif %}



        <!-- Middle column content (Selected Workout) -->
        {% if selected_workout and not selected_routine1 %}
        <div class="card">
            <div class = "card-image">
                <img src="{{selected_workout.exercise_image2}}" alt="" class="circle responsive-img smaller-image">
            </div>
            <div class="card-content">
                <span class = "card-title">
                {{selected_workout.exercise_name}}
                </span>
                <p>Workout Name: {{selected_workout.exercise_name}}</p>
                <p>Description: {{selected_workout.description}}</p>
                <p>Muscle Group: {{selected_workout.muscle_group}}</p>
                <p>Equipment: {{selected_workout.equipment}}</p>
                <p>Rating: {{selected_workout.rating}}</p>
            </div>  
        </div>
        {% endif %}
        <div class="card" id="routine-info">
            {%if selected_routine %}
            <a>Routine: {{selected_routine.name}}</a>
            {% for workout in selected_routine.workout %}
            <p>{{workout.workout_id}}</p>
            {% endfor %}
            {% endif %}
            <div>
        </div>
        </div>
    </div>

    <!-- Right Middle Column  -->
</div>


<section class="col s12 m3" style="margin-top: 5px; overflow-y:scroll; height: 86vh; padding-right: 15px; padding-left: 15px;">

  <!-- Right column content (Routines) -->
<ul id="slide-out" class="sidenav sidenav-fixed" style="right: 0; left: auto; margin-top: 0x; overflow-y: scroll; width: 25vw;">
    <nav class="nav-extended custom-black">
        <div class="nav-wrapper">
            <a href="#" style="font-size: 1.2em;" class="brand-logo">{{ current_user.username }}'s Routines </a>
            <a class="right" href="/logout">Logout</a>
        </div>

    </nav>

    <!-- Create Routine here -->
    <h6>Create a routine</h6>
    <form class="row" style="height: min-content;" method="POST" action="/app/create">
        <div class="card col s12" style="height: 20vh">
            <input id="routine_name" method="POST" type="text" name="routine_name">
            <label for="name_inline">Name</label>
            <input class="btn grey right bottom" type="submit" value="SUBMIT" id="createBtn" />
        </div>
    </form>

    <!-- Display Routines -->
    <h5>Select A Routine</h5>
        <div class="input-field col s12">
            <div class="scrollable-list collection with-scroller">
                {% for routine in routines %}
                <div class="collection-item" style="margin-bottom: 10px; display: block;">
                    <p>{{ routine.name }}</p>
                    <a href="/app/view/{{routine.routine_id}}"class="btn red left view-btn" id="viewBtn">View</a>
                    <a class="btn red left edit-btn" id="editBtn">Edit</a>
                </div>
                {% endfor %}
            </div>
        </div>
</ul>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function () {
    const addExerciseBtn = document.getElementById('add-exercise-btn');
    addExerciseBtn.addEventListener('click', function () {
        const selectedWorkoutId = document.getElementById('exercise-dropdown').value;
        const selectedRoutineId = '{{ selected_routine.routine_id }}'; // Assuming you have access to selected_routine in your template
        const url = `/addworkout/${selectedRoutineId}/${selectedWorkoutId}`;
        window.location.href = url;
    });
});
    document.addEventListener('DOMContentLoaded', function () {
        // Get elements
        const popup = document.getElementById('routine-popup');
        const editButtons = document.querySelectorAll('.edit-btn');
        const closePopupBtn = document.getElementById('close-popup-btn');

        // Function to show the pop-up
        function showPopup() {
            popup.style.display = 'block';
        }

        // Function to close the pop-up
        function closePopup() {
            popup.style.display = 'none';
        }

        // Add click event listener to edit buttons
        editButtons.forEach(function (button) {
            button.addEventListener('click', function () {
                showPopup();
            });
        });

        // Add click event listener to close button
        closePopupBtn.addEventListener('click', function () {
            closePopup();
        });
    });
</script>

{% endblock %}